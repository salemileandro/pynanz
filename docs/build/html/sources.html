

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Documentation &mdash; Pynanz  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to Pynanz’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Pynanz
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#stockdata-class">StockData (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#meanvariance-class">MeanVariance (class)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pynanz.indicators">indicators (module)</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pynanz</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Documentation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/sources.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="documentation">
<h1>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="stockdata-class">
<h2>StockData (class)<a class="headerlink" href="#stockdata-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pynanz.StockData">
<em class="property">class </em><code class="sig-prename descclassname">pynanz.</code><code class="sig-name descname">StockData</code><a class="reference internal" href="_modules/pynanz/StockData.html#StockData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData" title="Permalink to this definition">¶</a></dt>
<dd><p>StockData is a class to store <em>Open, High, Low, Close, Volume</em> (OHLCV) data of financial assets (e.g. stocks, ETFs).
The member function <a class="reference internal" href="#pynanz.StockData.download" title="pynanz.StockData.download"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.download()</span></code></a> can be called to download data from yahoofinance (uses
<a class="reference external" href="https://yahooquery.dpguthrie.com">yahooquery</a> as backend).</p>
<p>The main attribute of a <cite>StockData</cite> object is <cite>self.data</cite>, which is a pandas.DataFrame object. The index of the
DataFrame is a list of <cite>datetime.date</cite> object which correspond to <strong>trading</strong> days. The columns are muti-indexed:
they are tuple of size=2 whose first entry is the <cite>ticker symbol</cite> (e.g. “AAPL”, “GOOG”) and second the attribute
(e.g. “open”, “high”).</p>
<p>Financial indicators such as exponentially moving averages (EMA) or moving average convergence divergence (MACD)
can also be computed. Such indicators can be used to build investment strategies (see Strategy class).</p>
<p><strong>Note that:</strong></p>
<ul class="simple">
<li><p>Only daily data can be retrieved.</p></li>
<li><p>Ticker symbols are fully capitalized, e.g. “AAPL” (not “aapl”).</p></li>
<li><p>Attribute are lower case, e.g “close” (not “Close”/”CLOSE”).</p></li>
</ul>
<p><strong>List of attributes:</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Variables</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self.data</strong> (<em>pd.DataFrame</em>) – DataFrame containing the data.</p></li>
<li><p><strong>self.tickers</strong> (<em>list</em>) – List of ticker symbols considered in the self.data pd.DataFrame,
e.g. [“AAPL”, “GOOG”, “USFD”, “ARKF”]. Symbols are fully capitalized.</p></li>
<li><p><strong>self.attributes</strong> (<em>list</em>) – List of attributes available, e.g. [“close”, “open”, …].</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="pynanz.StockData.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for the StockData class. The object needs to be initialized using either</p>
<ul class="simple">
<li><p><a class="reference internal" href="#pynanz.StockData.download" title="pynanz.StockData.download"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.download()</span></code></a></p></li>
<li><p><a class="reference internal" href="#pynanz.StockData.load" title="pynanz.StockData.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.load()</span></code></a> (if a call to <a class="reference internal" href="#pynanz.StockData.save" title="pynanz.StockData.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.save()</span></code></a> was done before).</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.download">
<code class="sig-name descname">download</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tickers</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span>str<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">start_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.date<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.date<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tolerance</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">15</span></em>, <em class="sig-param"><span class="n">clean_nan_index</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.download"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.download" title="Permalink to this definition">¶</a></dt>
<dd><p>Download data from yahoo finance using <a class="reference external" href="https://yahooquery.dpguthrie.com">yahooquery</a> as backend.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>,</em><em>str</em>) – List of str or str that contains the ticker symbols of the considered assets, e.g.
[“AAPL”, “GOOG”, “USFD”, “ARKF”]. No default.</p></li>
<li><p><strong>start_date</strong> (<em>datetime.date</em>) – Starting date to consider the data. If unspecified, the API will try to fetch
starting from the oldest available date. Default = None.</p></li>
<li><p><strong>end_date</strong> (<em>datetime.date</em>) – End date (inclusive) for the date to be considered. If unspecified, it is set
to today (<cite>datetime.date.today()</cite>). Default = None.</p></li>
<li><p><strong>tolerance</strong> (<em>int</em>) – If <cite>start_date</cite> is specified, and <cite>tolerance &gt;= 0</cite>, then any asset whose oldest available
data is newer than than <cite>start_date</cite> up to <cite>tolerance</cite> days is discarded. This option is useful when one
needs to consider data that exist for long-time enough in their model. Setting <cite>tolerance</cite> a negative value
deactivate this feature. Default = 15.</p></li>
<li><p><strong>clean_nan_index</strong> (<em>bool</em>) – If true, indices (rows) of self.data which contains NaN values are cleaned. This
can be useful since American and European trading days are not always the same, because of varying holidays.
Default is True (recommended).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.ema">
<code class="sig-name descname">ema</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'close'</span></em>, <em class="sig-param"><span class="n">force_compute</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.ema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.ema" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given target (default=”close”), computes the Exponentially Moving Average (EMA) for every column
(“ticker_symbol”, “target”) of the pd.DataFrame self.data. This function applies
<a class="reference internal" href="#pynanz.indicators.ema" title="pynanz.indicators.ema"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.ema()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>span</strong> (<em>int</em>) – Time span, a positive integer. Default=10.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Name of the targeted attribute (e.g. “close”, “open”, …). Default=”close”.</p></li>
<li><p><strong>force_compute</strong> (<em>bool</em>) – If False and self.data contains already the columns, the computation is not executed.
Default=True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p>ValueError if <cite>span</cite> &lt;= 0.</p></li>
<li><p>ValueError if <cite>target</cite> is not a valid attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.future_return">
<code class="sig-name descname">future_return</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'close'</span></em>, <em class="sig-param"><span class="n">force_compute</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.future_return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.future_return" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given target (default=”close”), computes the future return over every (“ticker_symbol”, “target”)
columns of the pd.DataFrame self.data. This function applies <a class="reference internal" href="#pynanz.indicators.future_return" title="pynanz.indicators.future_return"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.future_return()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>horizon</strong> (<em>int</em>) – Time horizon, a positive integer. Default=1.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Name of the targeted attribute (e.g. “close”, “open”, …). Default=”close”.</p></li>
<li><p><strong>force_compute</strong> (<em>bool</em>) – If False and self.data contains already the columns, the computation is not executed.
Default=True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p>ValueError if <cite>horizon</cite> &lt;= 0.</p></li>
<li><p>ValueError if <cite>target</cite> is not a valid attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.is_trading_day">
<code class="sig-name descname">is_trading_day</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.date<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">day</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">month</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">year</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>int<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.is_trading_day"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.is_trading_day" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the date is an actual trading day, i.e. if it is included in the self.data.index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>date</strong> (<em>datetime.date</em><em>,</em><em>str</em>) – Date to check. Can be a datetime.date object or a str “DD-MM-YYYY”. If set to
None, <cite>day</cite>, <cite>month</cite> and <cite>year</cite> <strong>must</strong> be defined.</p></li>
<li><p><strong>day</strong> (<em>int</em>) – Day to check. Integer value from 1 to 31.</p></li>
<li><p><strong>month</strong> (<em>int</em>) – Month to check. Integer value from 1 to 12.</p></li>
<li><p><strong>year</strong> (<em>int</em>) – Year to check. Integer value, e.g. 2012.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the date is a trading day, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from a pickle file. Need <a class="reference internal" href="#pynanz.StockData.save" title="pynanz.StockData.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.save()</span></code></a> to be called in a previous run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Path to the pickle file, e.g. <cite>“./stock_data.pkl”</cite>. No default.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.macd">
<code class="sig-name descname">macd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">short_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">12</span></em>, <em class="sig-param"><span class="n">long_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">26</span></em>, <em class="sig-param"><span class="n">signal_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">9</span></em>, <em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'close'</span></em>, <em class="sig-param"><span class="n">force_compute</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.macd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.macd" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given target (default=”close”), computes the Moving Average Convergence Divergence (MACD) indicator over
every (“ticker_symbol”, “target”) columns of the pd.DataFrame self.data. This function applies
<a class="reference internal" href="#pynanz.indicators.macd" title="pynanz.indicators.macd"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.macd()</span></code></a>.</p>
<p>This functions creates three new colums: f”macd_{<cite>short_span</cite>}_{<cite>long_span</cite>}_{<cite>signal_span</cite>}”,
f”sig_macd_{<cite>short_span</cite>}_{<cite>long_span</cite>}_{<cite>signal_span</cite>}” and
f”hist_macd_{<cite>short_span</cite>}_{<cite>long_span</cite>}_{<cite>signal_span</cite>}”, which are the MACD, signal and histogram
respectively. If the target is not “close”, the target name will be prepended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>short_span</strong> (<em>int</em>) – Span for the fast EMA curve. Default=12.</p></li>
<li><p><strong>long_span</strong> (<em>int</em>) – Span for the slow EMA curve. Default=26.</p></li>
<li><p><strong>signal_span</strong> (<em>int</em>) – Span for the signal line. Default=9.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Target column to compute the indicator. Default=”close”.</p></li>
<li><p><strong>force_compute</strong> (<em>bool</em>) – If False and self.data contains already the columns, the computation is not executed.
Default=True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.newest_date">
<code class="sig-name descname">newest_date</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.newest_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.newest_date" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Newest date which is the last index of the the pd.DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.oldest_date">
<code class="sig-name descname">oldest_date</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.oldest_date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.oldest_date" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Oldest date which is the first index of the the pd.DataFrame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.past_return">
<code class="sig-name descname">past_return</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'close'</span></em>, <em class="sig-param"><span class="n">force_compute</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.past_return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.past_return" title="Permalink to this definition">¶</a></dt>
<dd><p>For a given target (default=”close”), computes the past return over every (“ticker_symbol”, “target”)
columns of the pd.DataFrame self.data. This function applies <a class="reference internal" href="#pynanz.indicators.past_return" title="pynanz.indicators.past_return"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.past_return()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>horizon</strong> (<em>int</em>) – Time horizon, a positive integer. Default=1.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Name of the targeted attribute (e.g. “close”, “open”, …). Default=”close”.</p></li>
<li><p><strong>force_compute</strong> (<em>bool</em>) – If False and self.data contains already the columns, the computation is not executed.
Default=True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p>ValueError if <cite>horizon</cite> &lt;= 0.</p></li>
<li><p>ValueError if <cite>target</cite> is not a valid attribute.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save data to a pickle file (pd.DataFrame.to_pickle call). Retrieve data using <a class="reference internal" href="#pynanz.StockData.load" title="pynanz.StockData.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.StockData.load()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Path to the pickle file, e.g. <cite>“./stock_data.pkl”</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.StockData.stochastic">
<code class="sig-name descname">stochastic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">period</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">14</span></em>, <em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'close'</span></em>, <em class="sig-param"><span class="n">force_compute</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/StockData.html#StockData.stochastic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.StockData.stochastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the stochastic indicator over every (“ticker_symbol”, “close”) columns of the pd.DataFrame
self.data. This function applies <a class="reference internal" href="#pynanz.indicators.stochastic" title="pynanz.indicators.stochastic"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.stochastic()</span></code></a>.</p>
<p>This functions creates two new colums: f”stochastic_{<cite>period</cite>}” and f”smoothed_stochastic_{<cite>period</cite>}”.
If the target is not “close”, the target name will be prepended.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>period</strong> (<em>int</em>) – Period defining the stochastic indicator. Default=14.</p></li>
<li><p><strong>target</strong> (<em>str</em>) – Target column to compute the indicator. Default=”close”.</p></li>
<li><p><strong>force_compute</strong> (<em>bool</em>) – If False and self.data contains already the columns, the computation is not executed.
Default=True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p>NotImplemented if target is not “close”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="meanvariance-class">
<h2>MeanVariance (class)<a class="headerlink" href="#meanvariance-class" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pynanz.MeanVariance">
<em class="property">class </em><code class="sig-prename descclassname">pynanz.</code><code class="sig-name descname">MeanVariance</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">risk_aversion</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">sigma_target</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">period</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">add_cash</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/MeanVariance.html#MeanVariance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.MeanVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>The MeanVariance class performs a Mean-Variance Portfolio Optimization. The optimization follows</p>
<div class="math notranslate nohighlight">
\[\max_{\mathbf{w}} \Bigg( \sum_{i=1}^{N} w_i \mathbb{E}[r_i]
- \lambda \sum_{i=1}^{N}\sum_{j=1}^{N} w_i w_j \Sigma_{ij} \Bigg)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{w}\)</span> is the weight vector (portfolio allocation weight), <span class="math notranslate nohighlight">\(\mathbb{E}[r_i]\)</span> the expected
return for asset <em>i</em>, <span class="math notranslate nohighlight">\(\lambda\)</span> the risk aversion parameter and <span class="math notranslate nohighlight">\(\Sigma_{ij}\)</span> the <em>ij</em>
element of the covariance matrix (measure of risk). For more details, see the MeanVariance.pdf file.
<a class="reference external" href="../../../../Notes/Notes.pdf">MeanVariance file</a></p>
<dl class="py method">
<dt id="pynanz.MeanVariance.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">risk_aversion</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">sigma_target</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>float<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">period</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em>, <em class="sig-param"><span class="n">add_cash</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/MeanVariance.html#MeanVariance.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.MeanVariance.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructor for the MeanVariance object. In the constructor, the parameters are set. To effectively solve
the Mean-Variance Portfolio optimization, you need to call <a class="reference internal" href="#pynanz.MeanVariance.solve" title="pynanz.MeanVariance.solve"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.MeanVariance.solve()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>float</em>) – Decay in the exponential weighting. Set alpha=0.0 for simple averaging. Default=0.0.</p></li>
<li><p><strong>risk_aversion</strong> (<em>float</em>) – Risk aversion parameter. Cannot be defined if <cite>sigma_target</cite> is not None. Default=10.0.</p></li>
<li><p><strong>sigma_target</strong> (<em>float</em>) – Annualized standard deviation target. Cannot be defined if <cite>risk_aversion</cite> is not
None. Solving for sigma_target requires bisection algorithm (more computationally demanding). Default=None</p></li>
<li><p><strong>period</strong> (<em>int</em>) – Number of data points to consider to compute average and covariance. Default=5.</p></li>
<li><p><strong>max_weight</strong> (<em>float</em>) – Maximum weighting that an asset can have. Doesn’t apply to the risk-free CASH asset (if
considered, see <cite>add_cash</cite> parameter). Must be in [0; 1]. Default=0.5.</p></li>
<li><p><strong>horizon</strong> (<em>int</em>) – Horizon used to compute the return. See <a class="reference internal" href="#pynanz.indicators.past_return" title="pynanz.indicators.past_return"><code class="xref py py-func docutils literal notranslate"><span class="pre">pynanz.indicators.past_return()</span></code></a>. Default=1.</p></li>
<li><p><strong>add_cash</strong> (<em>bool</em>) – If true, an extra asset named “CASH” is added as a risk-free, zero-return asset.
Default=True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pynanz.MeanVariance.horizon">
<code class="sig-name descname">horizon</code><a class="headerlink" href="#pynanz.MeanVariance.horizon" title="Permalink to this definition">¶</a></dt>
<dd><p>Horizon attribute</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">Default</dt>
<dd class="field-even"><p>lol</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pynanz.MeanVariance.solve">
<code class="sig-name descname">solve</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pynanz.StockData.StockData</span></em>, <em class="sig-param"><span class="n">mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'global'</span></em>, <em class="sig-param"><span class="n">start_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.datetime<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">end_date</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>datetime.datetime<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">delta_date</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/MeanVariance.html#MeanVariance.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.MeanVariance.solve" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – </p></li>
<li><p><strong>mode</strong> – </p></li>
<li><p><strong>start_date</strong> – </p></li>
<li><p><strong>end_date</strong> – </p></li>
<li><p><strong>delta_date</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pynanz.indicators">
<span id="indicators-module"></span><h2>indicators (module)<a class="headerlink" href="#module-pynanz.indicators" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pynanz.indicators.ema">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">ema</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pandas.Series</span></em>, <em class="sig-param"><span class="n">span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#ema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.ema" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the exponential moving average (ema) of a pd.Series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.Series.</em>) – Target data to compute the ema.</p></li>
<li><p><strong>span</strong> (<em>int.</em>) – Span to compute the data. The decay alpha=2/(span+1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ema of x as a pd.Series.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>ValueError if span &lt;= 0. TypeError if type(x) != pd.Series.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynanz.indicators.future_return">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">future_return</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pandas.Series</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#future_return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.future_return" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the future return over a fix time <em>horizon</em> of the pd.Series <em>x</em>. The future return <em>y</em> is defined as</p>
<div class="math notranslate nohighlight">
\[y[t] = \frac{ x[t+horizon] - x[t]}{x[t]}\]</div>
<p>If <cite>x</cite> has units of value, then <cite>y</cite> can be interpreted as an investment return.
In general, <cite>y</cite> measure the change over time horizon <cite>horizon</cite> of the quantity <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.Series.</em>) – Target data to compute the future return.</p></li>
<li><p><strong>horizon</strong> (<em>int.</em>) – Time horizon, a positive integer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pd.Series y.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>ValueError if horizon &lt;= 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynanz.indicators.macd">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">macd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pandas.Series</span></em>, <em class="sig-param"><span class="n">short_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">12</span></em>, <em class="sig-param"><span class="n">long_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">26</span></em>, <em class="sig-param"><span class="n">signal_span</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">9</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#macd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.macd" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Moving Average Convergence Divergence (MACD) indicator. The indicator is defined by a fast ema of span
<cite>short_span</cite> and a slow ema of span <cite>long_span</cite>. The MACD curve is defined by MACD = short_ema - long_ema.
The signal line is defined as the ema of span <cite>signal_span</cite> of the MACD curve. The MACD histogram is defined as
the difference between the MACD curve and the signal line. If the histogram has positive value, it suggests a
bullish market while a negative histogram suggests a bearish market. Take care that the indicator is not perfect
(false positive/negative) and typically lags in time (detects momentum reversal after they happen).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.Series</em>) – Target data to compute the macd.</p></li>
<li><p><strong>short_span</strong> (<em>int</em>) – Span for the fast EMA curve. Default=12.</p></li>
<li><p><strong>long_span</strong> (<em>int</em>) – Span for the slow EMA curve. Default=26.</p></li>
<li><p><strong>signal_span</strong> (<em>int</em>) – Span for the signal line. Default=9.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MACD, signal_line, histogram, a 3D tuple.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynanz.indicators.past_return">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">past_return</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pandas.Series</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#past_return"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.past_return" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the past return, that is the realized return, over a fix time <cite>horizon</cite> of the pd.Series <cite>x</cite>.
The past return <cite>y</cite> is defined as</p>
<div class="math notranslate nohighlight">
\[y[t] = \frac{ x[t] - x[t-horizon]}{x[t-horizon]}\]</div>
<p>If <cite>x</cite> has units of value, then <cite>y</cite> can be interpreted as an investment return.
In general, <cite>y</cite> measure the change over time horizon <cite>horizon</cite> of the quantity <cite>x</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.Series.</em>) – Target data to compute the future return.</p></li>
<li><p><strong>horizon</strong> (<em>int.</em>) – Time horizon, a positive integer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pd.Series y.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p>ValueError if horizon &lt;= 0.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynanz.indicators.stochastic">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">stochastic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">pandas.Series</span></em>, <em class="sig-param"><span class="n">x_low</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>pandas.Series<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">x_high</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>pandas.Series<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">period</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">14</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#stochastic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.stochastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the stochastic indicator as well as a smoothed version (ema of span period/3). The stochastic indicator
is defined as</p>
<div class="math notranslate nohighlight">
\[y[t] = 100.0 \frac{x[t] - \min(x_{low}[t-period+1:])}{\max(x_{high}[t-period+1:]) - \min(x_{low}[t-period+1:])}\]</div>
<p>If you don’t have access to a separate data for the low/high records of your data, the function uses the data
itself to compute them. For financial data, where high/low values are reached within a trading period, this might
not be optimal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>pd.Series</em>) – Target data to compute the stochastic indicator.</p></li>
<li><p><strong>x_low</strong> (<em>pd.Series</em>) – Minimum value of target data to compute the stochastic indicator.</p></li>
<li><p><strong>x_high</strong> (<em>pd.Series</em>) – Maximum value of target data to compute the stochastic indicator.</p></li>
<li><p><strong>period</strong> (<em>int</em>) – Period over which the stochastic indicator is computed. Default=14.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple (stochastic, stochastic_smoothed).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pynanz.indicators.test_func">
<code class="sig-prename descclassname">pynanz.indicators.</code><code class="sig-name descname">test_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pynanz/indicators.html#test_func"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pynanz.indicators.test_func" title="Permalink to this definition">¶</a></dt>
<dd><p>This function will try to calculate:</p>
<div class="math notranslate nohighlight">
\[\sum_{i=1}^{\infty} x_{i}\]</div>
<p>good luck!</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to Pynanz’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Leandro Salemi.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>